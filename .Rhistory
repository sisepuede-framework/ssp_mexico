test2$Units <- "NA"
test2$Data_Type <- "sisepuede simulation"
test2$iso_code3<- iso_code3
test2$Country <- region
test2$region <- NULL
test2$subsector_total_field <- NULL
#test2$model_variable <- NULL
test2$gas <- NA
test2$model_variable_information <- NULL
test2$output_type<- "drivers"
#create an additional sector variable for energy
energy_vars <- data.frame(variable=subset(unique(test2$variable),grepl("energy",unique(test2$variable))==TRUE ))
energy_vars$energy_subsector <-"TBD"
energy_vars$energy_subsector <- ifelse(grepl("ccsq",energy_vars$variable)==TRUE,"Carbon Capture and Sequestration",energy_vars$energy_subsector )
energy_vars$energy_subsector <- ifelse(grepl("inen",energy_vars$variable)==TRUE,"Industrial Energy",energy_vars$energy_subsector )
energy_vars$energy_subsector <- ifelse(grepl("entc",energy_vars$variable)==TRUE,"Power(electricity/heat)",energy_vars$energy_subsector )
energy_vars$energy_subsector <- ifelse(grepl("trns",energy_vars$variable)==TRUE,"Transportation",energy_vars$energy_subsector )
energy_vars$energy_subsector <- ifelse(grepl("scoe",energy_vars$variable)==TRUE,"Buildings",energy_vars$energy_subsector )
#merge energy vars with test2
dim(test2)
test2 <- merge(test2,energy_vars,by="variable", all.x=TRUE)
dim(test2)
test2 <- test2[order(test2$strategy_id,test2$model_variable,test2$subsector,test2$category_value,test2$Year),]
#saved_data <- test2
#test2 <- saved_data
##
test2$ids <- paste(test2$variable,test2$subsector,test2$category_value,test2$strategy_id,sep=":")
ids_all <- unique(test2$ids)
test2$value_new <- 0
for (i in 1:length(ids_all))
{
if (grepl("prod_ippu_glass_tonne:IPPU",ids_all[i])==TRUE)
{
pivot <-subset(test2,ids==ids_all[i] & test2$Year%in%c(2022:2030,2070))[,c("value","Year")]
pivot$value[pivot$Year==2050] <- pivot$value[pivot$Year==2030]*1.5
pivot <- subset(pivot,Year%in%c(2022:2025,2070))
inter_fun <- approxfun(x=as.numeric(pivot$Year), y=as.numeric(pivot$value), rule = 2:1)
test2[test2$ids==ids_all[i],"value_new"] <- inter_fun(test2[test2$ids==ids_all[i],"Year"])
}
if (grepl("prod_ippu_metals_tonne:IPPU",ids_all[i])==TRUE)
{
pivot <-subset(test2,ids==ids_all[i] & test2$Year%in%c(2022:2030,2070))[,c("value","Year")]
pivot$value[pivot$Year==2050] <- pivot$value[pivot$Year==2030]*2.0
pivot <- subset(pivot,Year%in%c(2022:2025,2070))
inter_fun <- approxfun(x=as.numeric(pivot$Year), y=as.numeric(pivot$value), rule = 2:1)
test2[test2$ids==ids_all[i],"value_new"] <- inter_fun(test2[test2$ids==ids_all[i],"Year"])
}
if (grepl("prod_ippu_rubber_and_leather_tonne:IPPU",ids_all[i])==TRUE)
{
pivot <-subset(test2,ids==ids_all[i] & test2$Year%in%c(2022:2030,2070))[,c("value","Year")]
pivot$value[pivot$Year==2050] <- pivot$value[pivot$Year==2030]*1.5
pivot <- subset(pivot,Year%in%c(2022:2025,2070))
inter_fun <- approxfun(x=as.numeric(pivot$Year), y=as.numeric(pivot$value), rule = 2:1)
test2[test2$ids==ids_all[i],"value_new"] <- inter_fun(test2[test2$ids==ids_all[i],"Year"])
}
if (grepl("prod_ippu_textiles_tonne:IPPU",ids_all[i])==TRUE)
{
pivot <-subset(test2,ids==ids_all[i] & test2$Year%in%c(2022:2030,2070))[,c("value","Year")]
pivot$value[pivot$Year==2050] <- pivot$value[pivot$Year==2030]*1.5
pivot <- subset(pivot,Year%in%c(2022:2025,2070))
inter_fun <- approxfun(x=as.numeric(pivot$Year), y=as.numeric(pivot$value), rule = 2:1)
test2[test2$ids==ids_all[i],"value_new"] <- inter_fun(test2[test2$ids==ids_all[i],"Year"])
}
else {}
}
#subsitute value
test2$value <- ifelse(test2$value_new==0,test2$value,test2$value_new)
test2$value_new <- NULL
gdp <- fread(paste0(dir.output,output.file))
gdp <- gdp[primary_id==0]
gdp <- subset(gdp,select=c("time_period","gdp_mmm_usd"))
gdp$year <- (gdp$time_period) + 2015
gdp <- subset(gdp,select=c("year","gdp_mmm_usd"))
gdp <- gdp[year<=2022]
build_drivers_table <- function(hist_dt,
strategies_dt,
iso_code3 = "MEX",
country   = "mexico",
data_type = "historical") {
# hist_dt:       columnas c("year", "gdp_mmm_usd")
# strategies_dt: columnas c("strategy_id","design_id","future_id","strategy")
hist_dt       <- as.data.table(hist_dt)
strategies_dt <- as.data.table(strategies_dt)
# Renombrar columnas histÃ³ricas
hist_dt[, `:=`(Year  = year,
value = gdp_mmm_usd)]
hist_dt[, c("year","gdp_mmm_usd") := NULL]
# Cross join (todas las estrategias x todos los aÃ±os)
strategies_dt[, dummy := 1]
hist_dt[, dummy := 1]
out <- strategies_dt[hist_dt, on = "dummy", allow.cartesian = TRUE]
out[, dummy := NULL]
# Variables constantes
out[, `:=`(
variable        = "gdp_mmm_usd",
primary_id      = 0L,
sector          = "Socioeconomic",
subsector       = "Economy",
model_variable  = "GDP",
category_value  = "('', '')",
category_name   = "cat_economy",
gas             = NA_character_,
gas_name        = "",
Units           = "NA",
Data_Type       = data_type,
iso_code3       = iso_code3,
Country         = country,
output_type     = "drivers",
energy_subsector= NA_character_,
ids             = "gdp_mmm_usd:Economy:('', ''):0"
)]
# Reordenar columnas exactamente como pediste
setcolorder(out, c(
"variable","strategy_id","primary_id","value","sector","subsector","model_variable",
"category_value","category_name","gas","gas_name","Year","design_id","future_id",
"strategy","Units","Data_Type","iso_code3","Country","output_type","energy_subsector","ids"
))
setorder(out, strategy_id, Year)
return(out[])
}
# Lista de estrategias (una fila por estrategia)
strategies_dt <- data.table(
strategy_id = unique(test2$strategy_id),
design_id   = unique(test2$design_id),
future_id   = unique(test2$future_id),
strategy    = unique(test2$strategy)
)
drivers_table <- build_drivers_table(gdp, strategies_dt)
drivers_table
# Filter drivers_table for years not present in test2 for the variable "gdp_mmm_usd"
years_in_test2 <- unique(test2$Year[test2$variable == "gdp_mmm_usd"])
last_year_in_test2 <- min(years_in_test2, na.rm = TRUE)
drivers_table <- drivers_table[drivers_table$Year < last_year_in_test2, ]
table(drivers_table$Year)
setcolorder(drivers_table, c(
"variable","strategy_id","primary_id","value","sector","subsector","model_variable",
"category_value","category_name","gas","gas_name","Year","design_id","future_id",
"strategy","Units","Data_Type","iso_code3","Country","output_type","energy_subsector","ids"
))
drivers_table$variable <- "gdp_mmm_usd"
test2 <- rbind(test2, drivers_table, fill = TRUE)
#write file
dir.tableau <- paste0("ssp_modeling/tableau/data/")
file.name <- paste0("drivers_",region,"_",output.file)
write.csv(test2,paste0(dir.tableau,file.name), row.names=FALSE)
print('Finish: data_prep_drivers process')
#################################################
# Post processing process
#################################################
# load packages
library(data.table)
library(reshape2)
library(mFilter)
library(ggplot2)
rm(list=ls())
#ouputfile
dir.output  <- "ssp_modeling/ssp_run_output/sisepuede_results_sisepuede_run_2025-09-30T11;28;10.980165/"
output.file <- "sisepuede_results_sisepuede_run_2025-09-30T11;28;10.980165_WIDE_INPUTS_OUTPUTS.csv"
region <- "mexico"
iso_code3 <- "MEX"
year_ref <- 2022
source('ssp_modeling/output_postprocessing/scr/run_script_baseline_run_new.r')
source('ssp_modeling/output_postprocessing/scr/data_prep_new_mapping.r')
source('ssp_modeling/output_postprocessing/scr/data_prep_drivers.r')
#create levers table for Uganda
#load levers table
#attach transformations descriptions
#read the transformation table
ssp_table <- read.csv(paste0(dir.output,"tableau_levers_table.csv" ))
View(ssp_table)
#create levers table for Uganda
#load levers table
#attach transformations descriptions
#read the transformation table
ssp_table <- read.csv(paste0(dir.output,"tableau_levers_table.csv" ))
ssp_table$transformation_code <- gsub("TFR:","",ssp_table$transformer_code)
#read descriptions
desp <- read.csv('ssp_modeling/output_postprocessing/data/levers/ssp_descriptions.csv')
#create levers table for Uganda
#load levers table
#attach transformations descriptions
#read the transformation table
ssp_table <- read.csv(paste0(dir.output,"tableau_levers_table.csv" ))
ssp_table$transformation_code <- gsub("TFR:","",ssp_table$transformer_code)
#read descriptions
desp <- read.csv('ssp_modeling/output_postprocessing/data/levers/ssp_descriptions.csv')
#read stakeholder codes
scodes <- read.csv("ssp_modeling/output_postprocessing/data/levers/stakeholder_codes.csv")
scodes$transformation_code <- gsub("TX:","",scodes$transformation_code)
#merge
dim(ssp_table)
dim(desp)
ssp_table <- merge(ssp_table,desp,by="transformation_code")
dim(ssp_table)
ssp_table <- merge(ssp_table,scodes[,c("transformation_code","transformation_name_stakeholder","Sector..output.","Subsector..output.","Example.government.policies")],by="transformation_code")
dim(ssp_table)
#create levers table for Uganda
#load levers table
#attach transformations descriptions
#read the transformation table
ssp_table <- read.csv(paste0(dir.output,"tableau_levers_table.csv" ))
ssp_table$transformation_code <- gsub("TFR:","",ssp_table$transformer_code)
#read descriptions
desp <- read.csv('ssp_modeling/output_postprocessing/data/levers/ssp_descriptions.csv')
#read stakeholder codes
scodes <- read.csv("ssp_modeling/output_postprocessing/data/levers/stakeholder_codes.csv")
scodes$transformation_code <- gsub("TX:","",scodes$transformation_code)
#merge
dim(ssp_table)
dim(desp)
ssp_table <- merge(ssp_table,desp,by="transformation_code")
dim(ssp_table)
ssp_table <- merge(ssp_table,scodes[,c("transformation_code","transformation_name_stakeholder","Sector..output.","Subsector..output.","Example.government.policies")],by="transformation_code")
dim(ssp_table)
write.csv(ssp_table,"/Users/fabianfuentes/git/ssp_mexico/ssp_modeling/tableau/data/tableau_levers_table_complete.csv")
#create jobs table
jobs_table <- read.csv("ssp_modeling/output_postprocessing/data/levers/Sisepuede - Employment Results - WB (SECTOR).csv")
dim(data.frame(unlist(strsplit(jobs_table$Strategy,": "))))
head(jobs_table)
#create jobs table
jobs_table <- read.csv("ssp_modeling/output_postprocessing/data/levers/Sisepuede - Employment Results - WB (SECTOR).csv")
dim(data.frame(unlist(strsplit(jobs_table$Strategy,": "))))
head(jobs_table)
ssp_table$transformation_code <- gsub("TFR:","",ssp_table$transformer_code)
#read descriptions
desp <- read.csv("ssp_modeling/output_postprocessing/data/levers/ssp_descriptions.csv")
#read stakeholder codes
scodes <- read.csv("ssp_modeling/output_postprocessing/data/levers/stakeholder_codes.csv")
scodes$transformation_code <- gsub("TX:","",scodes$transformation_code)
#create levers table for Uganda
#load levers table
#attach transformations descriptions
#read the transformation table
ssp_table <- read.csv(paste0(dir.output,"tableau_levers_table.csv" ))
ssp_table$transformation_code <- gsub("TFR:","",ssp_table$transformer_code)
#read descriptions
desp <- read.csv('ssp_modeling/output_postprocessing/data/levers/ssp_descriptions.csv')
#read stakeholder codes
scodes <- read.csv("ssp_modeling/output_postprocessing/data/levers/stakeholder_codes.csv")
scodes$transformation_code <- gsub("TX:","",scodes$transformation_code)
#merge
dim(ssp_table)
dim(desp)
ssp_table <- merge(ssp_table,desp,by="transformation_code")
dim(ssp_table)
ssp_table <- merge(ssp_table,scodes[,c("transformation_code","transformation_name_stakeholder","Sector..output.","Subsector..output.","Example.government.policies")],by="transformation_code")
dim(ssp_table)
write.csv(ssp_table,"ssp_modeling/tableau/data/tableau_levers_table_complete.csv")
#create jobs table
jobs_table <- read.csv("ssp_modeling/output_postprocessing/data/levers/Sisepuede - Employment Results - WB (SECTOR).csv")
dim(data.frame(unlist(strsplit(jobs_table$Strategy,": "))))
head(jobs_table)
ssp_table$transformation_code <- gsub("TFR:","",ssp_table$transformer_code)
#read descriptions
desp <- read.csv("ssp_modeling/output_postprocessing/data/levers/ssp_descriptions.csv")
#read stakeholder codes
scodes <- read.csv("ssp_modeling/output_postprocessing/data/levers/stakeholder_codes.csv")
scodes$transformation_code <- gsub("TX:","",scodes$transformation_code)
#merge
dim(ssp_table)
dim(desp)
ssp_table <- merge(ssp_table,desp,by="transformation_code")
dim(ssp_table)
ssp_table <- merge(ssp_table,scodes[,c("transformation_code","transformation_name_stakeholder","Sector..output.","Subsector..output.","Example.government.policies")],by="transformation_code")
dim(ssp_table)
write.csv(ssp_table,"ssp_modeling/tableau/data//tableau_levers_table_complete.csv")
View(jobs_table)
#create jobs table
jobs_table <- read.csv("ssp_modeling/output_postprocessing/data/levers/Sisepuede - Employment Results - WB (SECTOR).csv")
dim(data.frame(unlist(strsplit(jobs_table$Strategy,": "))))
head(jobs_table)
#create jobs table
jobs_table <- read.csv("ssp_modeling/output_postprocessing/data/levers/Sisepuede - Employment Results - WB (SECTOR).csv")
dim(data.frame(unlist(strsplit(jobs_table$Strategy,": "))))
head(jobs_table)
ssp_table$transformation_code <- gsub("TFR:","",ssp_table$transformer_code)
#read descriptions
desp <- read.csv("ssp_modeling/output_postprocessing/data/levers/ssp_descriptions.csv")
#read stakeholder codes
scodes <- read.csv("ssp_modeling/output_postprocessing/data/levers//stakeholder_codes.csv")
scodes$transformation_code <- gsub("TX:","",scodes$transformation_code)
#merge
dim(ssp_table)
dim(desp)
ssp_table <- merge(ssp_table,desp,by="transformation_code")
dim(ssp_table)
ssp_table <- merge(ssp_table,scodes[,c("transformation_code","transformation_name_stakeholder","Sector..output.","Subsector..output.","Example.government.policies")],by="transformation_code")
dim(ssp_table)
View(ssp_table)
View(ssp_table)
#create jobs table
jobs_table <- read.csv("ssp_modeling/output_postprocessing/data/levers/Sisepuede - Employment Results - WB (SECTOR).csv")
dim(data.frame(unlist(strsplit(jobs_table$Strategy,": "))))
head(jobs_table)
View(jobs_table)
#create jobs table
jobs_table <- read.csv("ssp_modeling/output_postprocessing/data/levers/Sisepuede - Employment Results - WB (SECTOR).csv")
dim(data.frame(unlist(strsplit(jobs_table$Strategy,": "))))
head(jobs_table)
jobs_table <- jobs_table[Country==iso_code3]
iso_code3
View(jobs_table)
#create jobs table
jobs_table <- read.csv("ssp_modeling/output_postprocessing/data/levers/Sisepuede - Employment Results - WB (SECTOR).csv")
dim(data.frame(unlist(strsplit(jobs_table$Strategy,": "))))
head(jobs_table)
#create jobs table
jobs_table <- read.csv("ssp_modeling/output_postprocessing/data/levers/Sisepuede - Employment Results - WB (SECTOR).csv")
dim(data.frame(unlist(strsplit(jobs_table$Strategy,": "))))
head(jobs_table)
jobs_table <- jobs_table[Country=='MEX']
View(jobs_table)
#create jobs table
jobs_table <- read.csv("ssp_modeling/output_postprocessing/data/levers/Sisepuede - Employment Results - WB (SECTOR).csv")
dim(data.frame(unlist(strsplit(jobs_table$Strategy,": "))))
head(jobs_table)
jobs_table <- jobs_table[Country=='MEX',]
View(jobs_table)
#create jobs table
jobs_table <- read.csv("ssp_modeling/output_postprocessing/data/levers/Sisepuede - Employment Results - WB (SECTOR).csv")
dim(data.frame(unlist(strsplit(jobs_table$Strategy,": "))))
head(jobs_table)
View(jobs_table)
jobs_table <- jobs_table[,Country=='MEX']
#create jobs table
jobs_table <- read.csv("ssp_modeling/output_postprocessing/data/levers/Sisepuede - Employment Results - WB (SECTOR).csv")
dim(data.frame(unlist(strsplit(jobs_table$Strategy,": "))))
head(jobs_table)
jobs_table <- jobs_table[Country=='MEX']
#create jobs table
jobs_table <- read.csv("ssp_modeling/output_postprocessing/data/levers/Sisepuede - Employment Results - WB (SECTOR).csv")
dim(data.frame(unlist(strsplit(jobs_table$Strategy,": "))))
head(jobs_table)
jobs_table <- jobs_table[Country=='MEX',]
View(jobs_table)
#create jobs table
jobs_table <- read.csv("ssp_modeling/output_postprocessing/data/levers/Sisepuede - Employment Results - WB (SECTOR).csv")
dim(data.frame(unlist(strsplit(jobs_table$Strategy,": "))))
head(jobs_table)
jobs_table <- subset(jobs_table, Country=='MEX')
View(jobs_table)
#create jobs table
jobs_table <- read.csv("ssp_modeling/output_postprocessing/data/levers/Sisepuede - Employment Results - WB (SECTOR).csv")
dim(data.frame(unlist(strsplit(jobs_table$Strategy,": "))))
head(jobs_table)
jobs_table <- subset(jobs_table, Country=='MEX')
write.csv("ssp_modeling/tableau/data/jobs_table_mex.csv")
#create jobs table
jobs_table <- read.csv("ssp_modeling/output_postprocessing/data/levers/Sisepuede - Employment Results - WB (SECTOR).csv")
dim(data.frame(unlist(strsplit(jobs_table$Strategy,": "))))
head(jobs_table)
jobs_table <- subset(jobs_table, Country=='MEX')
write.csv(jobs_table, "ssp_modeling/tableau/data/jobs_table_mex.csv")
View(jobs_table)
#create jobs table
jobs_table <- read.csv("ssp_modeling/output_postprocessing/data/levers/Sisepuede - Employment Results - WB (SECTOR).csv")
dim(data.frame(unlist(strsplit(jobs_table$Strategy,": "))))
head(jobs_table)
ssp_table$transformation_code <- gsub("TFR:","",ssp_table$transformer_code)
#read descriptions
desp <- read.csv("ssp_modeling/output_postprocessing/data/levers/ssp_descriptions.csv")
#read stakeholder codes
scodes <- read.csv("ssp_modeling/output_postprocessing/data/levers/stakeholder_codes.csv")
scodes$transformation_code <- gsub("TX:","",scodes$transformation_code)
#merge
dim(ssp_table)
dim(desp)
ssp_table <- merge(ssp_table,desp,by="transformation_code")
dim(ssp_table)
ssp_table <- merge(ssp_table,scodes[,c("transformation_code","transformation_name_stakeholder","Sector..output.","Subsector..output.","Example.government.policies")],by="transformation_code")
dim(ssp_table)
#create jobs table
jobs_table <- read.csv("ssp_modeling/output_postprocessing/data/levers/Sisepuede - Employment Results - WB (SECTOR).csv")
dim(data.frame(unlist(strsplit(jobs_table$Strategy,": "))))
head(jobs_table)
ssp_table$transformation_code <- gsub("TFR:","",ssp_table$transformer_code)
#read descriptions
desp <- read.csv("ssp_modeling/output_postprocessing/data/levers/ssp_descriptions.csv")
#read stakeholder codes
scodes <- read.csv("ssp_modeling/output_postprocessing/data/levers/stakeholder_codes.csv")
scodes$transformation_code <- gsub("TX:","",scodes$transformation_code)
#merge
dim(ssp_table)
dim(desp)
ssp_table <- merge(ssp_table,desp,by="transformation_code")
dim(ssp_table)
ssp_table <- merge(ssp_table,scodes[,c("transformation_code","transformation_name_stakeholder","Sector..output.","Subsector..output.","Example.government.policies")],by="transformation_code")
dim(ssp_table)
View(scodes)
View(strategies_dt)
#create jobs table
jobs_table <- read.csv("ssp_modeling/output_postprocessing/data/levers/Sisepuede - Employment Results - WB (SECTOR).csv")
dim(data.frame(unlist(strsplit(jobs_table$Strategy,": "))))
head(jobs_table)
ssp_table$transformation_code <- gsub("TFR:","",ssp_table$transformer_code)
#read descriptions
desp <- read.csv("ssp_modeling/output_postprocessing/data/levers/ssp_descriptions.csv")
#read stakeholder codes
scodes <- read.csv("ssp_modeling/output_postprocessing/data/levers/stakeholder_codes.csv")
scodes$transformation_code <- gsub("TX:","",scodes$transformation_code)
View(ssp_table)
jobs_table <- read.csv("ssp_modeling/output_postprocessing/data/levers/Sisepuede - Employment Results - WB (SECTOR).csv")
dim(data.frame(unlist(strsplit(jobs_table$Strategy,": "))))
head(jobs_table)
ssp_table$transformation_code <- gsub("TFR:","",ssp_table$transformer_code)
#read descriptions
desp <- read.csv("ssp_modeling/output_postprocessing/data/levers/ssp_descriptions.csv")
#read stakeholder codes
scodes <- read.csv("ssp_modeling/output_postprocessing/data/levers/stakeholder_codes.csv")
scodes$transformation_code <- gsub("TX:","",scodes$transformation_code)
#merge
dim(ssp_table)
dim(desp)
ssp_table <- merge(ssp_table,desp,by="transformation_code")
dim(ssp_table)
ssp_table <- merge(ssp_table,scodes[,c("transformation_code","transformation_name_stakeholder","Sector..output.","Subsector..output.","Example.government.policies")],by="transformation_code")
dim(ssp_table)
ssp_table <- merge(ssp_table, jobs_table)
#create jobs table
jobs_table <- read.csv("ssp_modeling/output_postprocessing/data/levers/Sisepuede - Employment Results - WB (SECTOR).csv")
dim(data.frame(unlist(strsplit(jobs_table$Strategy,": "))))
head(jobs_table)
#read the transformation table
ssp_table <- read.csv(paste0(dir.output,"tableau_levers_table.csv" ))
ssp_table$transformation_code <- gsub("TFR:","",ssp_table$transformer_code)
#read descriptions
desp <- read.csv("ssp_modeling/output_postprocessing/data/levers/ssp_descriptions.csv")
#read stakeholder codes
scodes <- read.csv("ssp_modeling/output_postprocessing/data/levers/stakeholder_codes.csv")
scodes$transformation_code <- gsub("TX:","",scodes$transformation_code)
#merge
dim(ssp_table)
dim(desp)
ssp_table <- merge(ssp_table,desp,by="transformation_code")
dim(ssp_table)
ssp_table <- merge(ssp_table,scodes[,c("transformation_code","transformation_name_stakeholder","Sector..output.","Subsector..output.","Example.government.policies")],by="transformation_code")
dim(ssp_table)
ssp_table <- merge(ssp_table, jobs_table)
View(ssp_table)
#create jobs table
jobs_table <- read.csv("ssp_modeling/output_postprocessing/data/levers/Sisepuede - Employment Results - WB (SECTOR).csv")
dim(data.frame(unlist(strsplit(jobs_table$Strategy,": "))))
head(jobs_table)
#create jobs table
jobs_table <- read.csv("ssp_modeling/output_postprocessing/data/levers/Sisepuede - Employment Results - WB (SECTOR).csv")
dim(data.frame(unlist(strsplit(jobs_table$Strategy,": "))))
head(jobs_table)
#read the transformation table
ssp_table <- read.csv(paste0(dir.output,"tableau_levers_table.csv" ))
ssp_table$transformation_code <- gsub("TFR:","",ssp_table$transformer_code)
#read descriptions
desp <- read.csv("ssp_modeling/output_postprocessing/data/levers/ssp_descriptions.csv")
#read stakeholder codes
scodes <- read.csv("ssp_modeling/output_postprocessing/data/levers/stakeholder_codes.csv")
scodes$transformation_code <- gsub("TX:","",scodes$transformation_code)
#merge
dim(ssp_table)
dim(desp)
ssp_table <- merge(ssp_table,desp,by="transformation_code")
dim(ssp_table)
ssp_table <- merge(ssp_table,scodes[,c("transformation_code","transformation_name_stakeholder","Sector..output.","Subsector..output.","Example.government.policies")],by="transformation_code")
dim(ssp_table)
ssp_table <- merge(ssp_table, jobs_table)
rm(list=ls())
#create jobs table
jobs_table <- read.csv("/Users/edmun/Library/CloudStorage/OneDrive-Personal/Edmundo-ITESM/3.Proyectos/51. WB Decarbonization Project/Uganda_NDC_3/Tableau/2025_09_27/Sisepuede - Employment Results - WB (SECTOR).csv")
rm(list=ls())
#create jobs table
jobs_table <- read.csv("ssp_modeling/output_postprocessing/data/levers/Sisepuede - Employment Results - WB (SECTOR).csv")
dim(data.frame(unlist(strsplit(jobs_table$Strategy,": "))))
head(jobs_table)
#read the transformation table
ssp_table <- read.csv(paste0(dir.output,"tableau_levers_table.csv" ))
#################################################
# Post processing process
#################################################
# load packages
library(data.table)
library(reshape2)
library(mFilter)
library(ggplot2)
rm(list=ls())
#ouputfile
dir.output  <- "ssp_modeling/ssp_run_output/sisepuede_results_sisepuede_run_2025-09-30T11;28;10.980165/"
output.file <- "sisepuede_results_sisepuede_run_2025-09-30T11;28;10.980165_WIDE_INPUTS_OUTPUTS.csv"
region <- "mexico"
iso_code3 <- "MEX"
year_ref <- 2022
#read the transformation table
ssp_table <- read.csv(paste0(dir.output,"tableau_levers_table.csv" ))
ssp_table$transformation_code <- gsub("TFR:","",ssp_table$transformer_code)
head(ssp_table)
#create jobs table
jobs_table <- read.csv("ssp_modeling/output_postprocessing/data/levers/Sisepuede - Employment Results - WB (SECTOR).csv")
dim(data.frame(unlist(strsplit(jobs_table$Strategy,": "))))
head(jobs_table)
View(jobs_table)
#################################################
# Post processing process
#################################################
# load packages
library(data.table)
library(RColorBrewer)
library(ggplot2)
library(scales)
rm(list=ls())
df <- fread('ssp_modeling/ssp_run_output/sisepuede_results_sisepuede_run_2025-10-23T13;32;38.383522/sisepuede_results_sisepuede_run_2025-10-23T13;32;38.383522_WIDE_INPUTS_OUTPUTS.csv')
#df <- fread('ssp_modeling/ssp_run_output/sisepuede_results_sisepuede_run_2025-10-23T13;32;38.383522/uganda.csv')
att <- fread('ssp_modeling/ssp_run_output/sisepuede_results_sisepuede_run_2025-10-23T13;32;38.383522/ATTRIBUTE_PRIMARY.csv')
stt <- fread('ssp_modeling/ssp_run_output/sisepuede_results_sisepuede_run_2025-10-23T13;32;38.383522/ATTRIBUTE_STRATEGY.csv')
area <- grep("^area_lndu", colnames(df), value = TRUE)
area
